<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Meu Perfil - MASQUEKO</title>
    
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#7c3aed">
    <link rel="apple-touch-icon" href="/assets/logo-masqueko.png">
    
    <link rel="icon" type="image/png" href="/assets/logo-masqueko.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/perfil-style.css">
    
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
    <header class="navbar">
        <div class="navbar-content">
            <a href="/pages/home.html" class="logo">
                <img src="/assets/logo-masqueko.png" alt="Logo MASQUEKO" class="logo-img">
                <span>MASQUEKO</span>
            </a>
            <nav class="navbar-links">
                <a href="/pages/home.html" class="navbar-link">Início</a>
                <a href="/pages/comunidades.html" class="navbar-link">Comunidades</a>
                <a href="/pages/amigos.html" class="navbar-link">Amigos</a>
                <a href="/pages/saved.html" class="navbar-link"><i class="fa-solid fa-bookmark"></i> Salvos</a>
            </nav>
            
            <div class="user-menu">
                <a href="/pages/chat.html" class="notification-bell" id="notificationBell" title="Mensagens">
                    <i class="fa-solid fa-bell"></i>
                    <span id="notificationDot"></span>
                </a>
                <span id="navUsername">Carregando...</span>
                <img src="/assets/profile-pic.png" alt="Foto do Usuário" id="navUserPic">
                <button id="logoutButton" title="Sair" aria-label="Sair"><i class="fa-solid fa-right-from-bracket"></i></button>
            </div>
        </div>
    </header>

    <div class="main-content-wrapper">
        <main class="profile-grid">
            <div class="feed-column">
                <div class="create-post-box card" id="createPostContainer">
                    <h3>Criar Postagem</h3>
                    <form id="createPostForm">
                        <textarea id="postContentInput" name="conteudo" placeholder="No que você está pensando? (#hashtag)" required></textarea>
                        
                        <input type="file" id="postMediaFile" accept="image/*,video/*" class="input-file-hidden">
                        <label for="postMediaFile" class="input-file-label"><i class="fa-solid fa-cloud-arrow-up"></i> <span>Escolher Arquivo</span></label>
                        
                        <input type="url" id="postImageUrlInput" class="url-input" placeholder="Ou cole um link de imagem/vídeo aqui..." style="width: 100%; padding: 0.75rem; margin-bottom: 1rem; border: 1px solid var(--border-color); border-radius: var(--border-radius-sm);">

                        <select id="postCommunitySelect">
                            <option value="" disabled selected>Carregando opções...</option>
                        </select>
                        <button type="submit">Publicar</button>
                    </form>
                </div>
                <hr class="section-divider" id="postDivider">
                <div id="feedContainer"><p>Carregando posts...</p></div>
            </div>
            
            <aside class="profile-column">
                <div class="profile-card card">
                    <div class="profile-header" id="profileHeaderContainer">
                        </div>
                    <img src="/assets/profile-pic.png" alt="Foto de Perfil" class="profile-picture" id="profilePicture">
                    <div class="profile-body">
                        <h2 id="profileName">Carregando...</h2>
                        <p id="profileBio">Carregando bio...</p>
                        <div class="profile-tags" id="profileTagsContainer"></div>
                        <div class="profile-badges" id="profileBadgesContainer"></div>
                        <div class="profile-actions" id="profileActionsContainer"></div>
                    </div>
                </div>

                <div class="card trending-card">
                    <h3><i class="fa-solid fa-fire"></i> Em Alta</h3>
                    <ul class="trending-list" id="trendingListContainer">
                        <li>Carregando...</li>
                    </ul>
                </div>
            </aside>
        </main>
    </div>

    <footer class="footer">
        <p>&copy; 2024 MASQUEKO. Todos os direitos reservados.</p>
    </footer>

    <div id="editProfileModal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="modal-title-profile">
        <div class="modal-content">
            <header class="modal-header">
                <h2 id="modal-title-profile">Editar Perfil</h2>
                <button id="closeEditProfileModalBtn" class="close-btn" aria-label="Fechar modal">&times;</button>
            </header>
            <form id="editProfileForm">
                <div class="form-group">
                    <label for="editNameInput">Nome:</label>
                    <input type="text" id="editNameInput" required>
                </div>
                <div class="form-group">
                    <label for="editBioInput">Bio:</label>
                    <textarea id="editBioInput"></textarea>
                </div>
                <div class="form-group">
                    <label for="editTagsInput">Tags (separadas por vírgula):</label>
                    <input type="text" id="editTagsInput" placeholder="Ex: Gamer, Desenvolvedor, Músico">
                </div>
                <div class="form-group">
                    <label for="editAvatarFile">Foto de Perfil (Avatar):</label>
                    <input type="file" id="editAvatarFile" accept="image/*" class="input-file-hidden">
                    <label for="editAvatarFile" class="input-file-label"><i class="fa-solid fa-cloud-arrow-up"></i> <span>Escolher Foto</span></label>
                    <input type="url" id="editAvatarInput" placeholder="Ou URL da imagem" style="margin-top:0.5rem; width:100%; padding:0.5rem;">
                </div>
                <div class="form-group">
                    <label for="editBannerFile">Foto de Capa (Banner):</label>
                    <input type="file" id="editBannerFile" accept="image/*" class="input-file-hidden">
                    <label for="editBannerFile" class="input-file-label"><i class="fa-regular fa-image"></i> <span>Escolher Banner</span></label>
                    <input type="url" id="editBannerInput" placeholder="Ou URL do banner" style="margin-top:0.5rem; width:100%; padding:0.5rem;">
                </div>
                <button type="submit" class="submit-btn">Salvar Alterações</button>
            </form>
        </div>
    </div>
    
    <div id="editPostModal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="modal-title-post">
        <div class="modal-content">
            <header class="modal-header">
                <h2 id="modal-title-post">Editar Postagem</h2>
                <button id="closeEditPostModalBtn" class="close-btn" aria-label="Fechar modal">&times;</button>
            </header>
            <form id="editPostForm">
                <input type="hidden" id="editPostIdInput">
                <div class="form-group">
                    <label for="editPostContentInput">Conteúdo:</label>
                    <textarea id="editPostContentInput" rows="5" required></textarea>
                </div>
                <div class="form-group">
                    <label for="editPostImageUrlInput">URL da Mídia:</label>
                    <input type="url" id="editPostImageUrlInput">
                </div>
                <button type="submit" class="submit-btn">Salvar Alterações</button>
            </form>
        </div>
    </div>

    <div id="notification"></div>

    <nav class="mobile-bottom-nav">
        <a href="/pages/home.html" class="mobile-nav-item">
            <i class="fa-solid fa-house"></i>
            <span>Início</span>
        </a>
        <a href="/pages/comunidades.html" class="mobile-nav-item">
            <i class="fa-solid fa-users"></i>
            <span>Comunidades</span>
        </a>
        <a href="/pages/saved.html" class="mobile-nav-item">
            <i class="fa-solid fa-bookmark"></i>
            <span>Salvos</span>
        </a>
        <a href="/pages/amigos.html" class="mobile-nav-item">
            <i class="fa-solid fa-user-group"></i>
            <span>Amigos</span>
        </a>
        <a href="/pages/perfil.html" class="mobile-nav-item active">
            <i class="fa-solid fa-user"></i>
            <span>Perfil</span>
        </a>
        <button id="mobileLogoutBtn" class="mobile-nav-item" style="background:none; border:none; cursor:pointer; color: #ef4444;">
            <i class="fa-solid fa-right-from-bracket"></i>
            <span>Sair</span>
        </button>
    </nav>

    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-storage-compat.js"></script>
    
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>

    <script src="/js/api.js"></script>
    <script src="/js/perfil-script.js"></script>
</body>
</html>